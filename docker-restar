🔄 Full Restart Guide for Your Docker Setup
1. Go to project root
cd ~/ZaltixSchool


Your structure should look like:

docker-compose.yml
backend/
Eshcul/
sphere-entry-animated-home-main/

2. Dockerfiles
(a) Backend → backend/Dockerfile
FROM node:18

WORKDIR /app

# Copy dependencies first
COPY package*.json ./
RUN npm install

# Copy source code
COPY . .

# Expose backend port
EXPOSE 5000

# Start backend
CMD ["node", "index.js"]

(b) Eshcul (Expo web app) → Eshcul/Dockerfile

⚠️ npm start only runs Expo dev server (wrong for production).
To serve it like your web app, change to a build + Nginx approach:

# Build stage
FROM node:18 AS build
WORKDIR /app

COPY package*.json ./
RUN npm install
COPY . .

# Build Expo for web (will generate web-build/)
RUN npm run web

# Serve with Nginx
FROM nginx:alpine
COPY --from=build /app/web-build /usr/share/nginx/html

# Nginx config for SPA routing
RUN echo 'server { \
    listen 80; \
    server_name localhost; \
    root /usr/share/nginx/html; \
    index index.html; \
    location / { \
        try_files $uri /index.html; \
    } \
}' > /etc/nginx/conf.d/default.conf

EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]

(c) Sphere-entry (frontend) → sphere-entry-animated-home-main/Dockerfile
# Build stage
FROM node:18 AS build
WORKDIR /app

COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

# Serve with Nginx
FROM nginx:alpine
COPY --from=build /app/dist /usr/share/nginx/html

# Nginx config for SPA routing
RUN echo 'server { \
    listen 80; \
    server_name localhost; \
    root /usr/share/nginx/html; \
    index index.html; \
    location / { \
        try_files $uri /index.html; \
    } \
}' > /etc/nginx/conf.d/default.conf

EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]

3. docker-compose.yml
version: "3.8"
services:
  backend:
    build: ./backend
    container_name: zaltixschool-backend
    ports:
      - "5000:5000"

  eshcul:
    build: ./Eshcul
    container_name: zaltixschool-eshcul
    ports:
      - "8081:80"

  web:
    build: ./sphere-entry-animated-home-main
    container_name: zaltixschool-sphere
    ports:
      - "8083:80"

4. Clean old containers & images
docker-compose down -v --rmi all


This removes old containers, volumes, and images.

5. Rebuild and start
docker-compose up --build -d

6. Verify containers
docker ps


Expected:

backend → 0.0.0.0:5000->5000/tcp
eshcul → 0.0.0.0:8081->80/tcp
web     → 0.0.0.0:8083->80/tcp 

docker-compose down -v --rmi all
docker-compose up --build -d


================================================================ 

📌 File: zaltixschool.sh
#!/bin/bash
# ZaltixSchool Project Manager Script
# Usage: ./zaltixschool.sh up | down | restart | status | logs

PROJECT_DIR="/root/ZaltixSchool"

cd $PROJECT_DIR || { echo "❌ Project directory not found"; exit 1; }

case "$1" in
  up)
    echo "🚀 Starting ZaltixSchool stack..."
    docker-compose down -v --remove-orphans
    docker-compose build
    docker-compose up -d
    ;;

  down)
    echo "🛑 Stopping ZaltixSchool stack..."
    docker-compose down -v --remove-orphans
    ;;

  restart)
    echo "🔄 Restarting ZaltixSchool stack..."
    docker-compose down -v --remove-orphans
    docker-compose build
    docker-compose up -d
    ;;

  status)
    echo "📊 Checking running containers..."
    docker ps --filter "name=zaltixschool"
    ;;

  logs)
    echo "📜 Showing logs (Ctrl+C to exit)..."
    docker-compose logs -f
    ;;

  *)
    echo "⚡ Usage: $0 {up|down|restart|status|logs}"
    exit 1
    ;;
esac

✅ Setup Once
cd /root/ZaltixSchool
nano zaltixschool.sh   # paste the script above
chmod +x zaltixschool.sh

🚀 Usage

First time (or rebuild all):

./zaltixschool.sh up


Stop everything:

./zaltixschool.sh down


Restart stack:

./zaltixschool.sh restart


Check containers:

./zaltixschool.sh status


Follow logs:

./zaltixschool.sh logs


######################################## 

